"use strict";var e,r=(e=require("node-fetch"))&&"object"==typeof e&&"default"in e?e.default:e;class s{constructor(e,r,s){s&&(this._source=s),this._options={production:e},r&&Object.assign(this._options,{preview:r})}_process(e,r){return e=JSON.parse(e),r.preprocess?("content"===r.preprocess[0]&&(Array.isArray(e)?e.map(e=>{e.content&&(e.content=r.preprocess[1](e.content))}):e.content&&(e.content=r.preprocess[1](e.content))),"item"===r.preprocess[0]&&(Array.isArray(e)?e.map(e=>r.preprocess[1](e)):e=r.preprocess[1](e)),"collection"===r.preprocess[0]&&Array.isArray(e)&&(e=r.preprocess[1](e)),e):e}get(e){var s=this._options;const o=process.browser?window.fetch:r;var t;return t="development"===process.env.NODE_ENV&&s.preview&&"undefined"!==this._source?s.preview:s.production,console.log("browser - "+!process.browser),console.log("source - "+this._source),console.log("preview - "+s.preview),console.log(`${t}${e}`),o(`${t}${e}`).then(e=>e.text()).then(e=>{try{return this._process(e,s)}catch(r){return e}})}preprocess(e,r){Object.assign(this._options,{preprocess:[e,r]})}}module.exports=function(e){return new class{constructor(e){e&&(this._source=e)}client(e){return new s(e,"http://localhost:4000/",this._source)}}(e)};
