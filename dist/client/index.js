"use strict";var e,r=(e=require("node-fetch"))&&"object"==typeof e&&"default"in e?e.default:e;function o(e,r,s){var t;for(t in e)t===r?e[r]=s(e[r]):"object"==typeof e[t]&&o(e[t],r,s)}class s{constructor(e,r,o){o&&(this._source=o),this._options={production:e},r&&Object.assign(this._options,{preview:r})}_process(e,r){return e=JSON.parse(e),r.preprocess?("content"===r.preprocess[0]&&(Array.isArray(e)?e.map(e=>{e.content&&o(e,"content",r.preprocess[1])}):o(e,"content",r.preprocess[1])),"item"===r.preprocess[0]&&(Array.isArray(e)?e.map(e=>r.preprocess[1](e)):e=r.preprocess[1](e)),"collection"===r.preprocess[0]&&Array.isArray(e)&&(e=r.preprocess[1](e)),e):e}get(e){var o=this._options;const s=process.browser?window.fetch:r;var t;return t="development"===process.env.NODE_ENV?o.preview&&"undefined"!==this._source?o.preview:o.production:o.production?o.production:o.preview,console.log("production - "+o.production),console.log("browser - "+!process.browser),console.log("source - "+this._source),console.log("preview - "+o.preview),console.log(`${t}${e}`),s(`${t}${e}`).then(e=>e.text()).then(e=>{try{return this._process(e,o)}catch(r){return e}})}preprocess(e,r){Object.assign(this._options,{preprocess:[e,r]})}}module.exports=function(e){return new class{constructor(e){e&&(this._source=e)}client(e){return new s(e,"http://localhost:4000/",this._source)}}(e)};
